module HSON (HSON, Key, Value (Boolean, Number, String, Array, Object, Null, Integer), hsonEmpty, hsonSchool, hsonDog, hsonArray, hsonSingle) where

import Control.Monad qualified as Monad
import Data.Map
import Data.Map qualified as Map
import GHC.Arr (Array)
import Parser qualified as P
import Test.QuickCheck
  ( Arbitrary (..),
    Gen,
    frequency,
    listOf,
    oneof,
    sample',
    sized,
  )

------------------------- Defining HSON  ----------------------------------

data Value
  = String String
  | Integer Int
  | Number Double
  | Boolean Bool
  | Array [Value]
  | Object HSON
  | Null
  deriving (Eq, Show)

type Key = String

type HSON = [(Key, Value)]

------------------------- HSON Generator  ----------------------------------

genList :: forall a. (Arbitrary a) => Gen [a]
genList = sized gen
  where
    gen :: Int -> Gen [a]
    gen n =
      frequency
        [ (1, return []),
          (n, Monad.liftM2 (:) arbitrary (gen (n `div` 2)))
        ]

genChar :: Gen Char
genChar = oneof [return 'a', return 'b', return 'c', return 'd']

genValue :: Gen Value
genValue =
  frequency
    [ (8, fmap String (listOf genChar)),
      (4, fmap Integer (arbitrary :: Gen Int)),
      (4, fmap Number (arbitrary :: Gen Double)),
      (3, fmap Boolean (arbitrary :: Gen Bool)),
      (5, fmap Array genList),
      (1, fmap Object genHSON),
      (1, return Null)
    ]

-- >>> sample' genValue
-- [Integer 0,Number 1.482038566185,Number (-0.18688516311461165),Number 5.6291743727845,Null,String "ddbaadbc",Number 1.0030608518726052,String "d",Number (-11.369217630535154),Integer 6,Integer (-8)]

-- genHSON :: Gen HSON
-- genHSON = genList :: Gen [(Key, Value)]

genHSON :: Gen HSON
genHSON = listOf $ (,) <$> listOf genChar <*> genValue

-- >>> sample' genHSON
-- [[],[("a",String "c"),("aa",Integer 1)],[("bb",String "")],[("cbccc",Number (-3.9714884102670993)),("",Array [String "aabcc",Integer (-2),Integer (-2)])],[("dccca",String "bddcb"),("adabdd",Array []),("abdbcba",Array [Array [String "",String "aababc"]])],[("ddabdcab",Integer (-7)),("bdcbabcaad",String "ad"),("caadccb",Integer 6),("dcbacdbcc",String "abcabc"),("",Array [Array [Number (-5.469550913297907),Null],Number 7.756928012122538,Integer 8,Array [Null,String "d"]]),("d",String "dddc"),("cd",Integer (-4)),("cddcb",Integer (-9)),("ccdbb",String "dbdaccbb")],[("bdbacddcd",Integer (-8)),("dcbbaadd",String "cdaaaac"),("",String "cbdcabdd"),("bccbacdbccc",Boolean True)],[("cdddbadccadc",String "cbcbbacda"),("bbccbb",Number (-0.9840242335677433)),("bbadcbbcab",String "cdcdabdbcbcba"),("ddaddbdbabdac",Array [Integer (-3),Object [("aaccdabdcbaaa",Array [Boolean True,Integer (-12),Array [String "bcdbccaddccaa",Integer (-3),String "dcdbd",Array [Array [Boolean False,Number 10.569178322074633,Number 6.34271867302193,Array [String "abbb",Boolean False,String "ac"]],Number (-12.991775844345401),Array [String "bbbccdcdbca"],Integer 1]]]),("cbdbacdb",String "dbcaabbcdacaa"),("ccbbdaadccb",Null),("ccaccdbdbdbc",Integer 11),("cab",Integer (-2)),("dacabd",Number 2.433267299692451),("bcad",Boolean False),("aacd",Number 4.694701655669333),("adacab",String "")],Array [String "ab",Null,String "c",String ""]]),("c",String "bbabdbabbdbab"),("baccaaccaddcaa",Number (-1.2747691671693193)),("acbdbdddddbcd",String "b"),("bdadcccaab",Array [Array [Boolean False,Integer (-9),Array [Number 0.4955925625915189,Null]],String "bdb",Array [Number (-10.030453415011962),String "",Integer (-13)]]),("adbdcba",String "dbacbbaa"),("d",Object [("cdcbbcbdb",String "cadaaacdb"),("ccabbabc",String "bdccdcdccbddb"),("dba",String "badcdcbdda"),("ca",Boolean False),("ba",String "cab"),("cacbad",Number 9.8736276961822),("acabdcadab",Object [("aaddbcc",String "cbaabcbbb"),("dadddcddaaaa",String "ddb"),("acbacadd",Boolean True),("ccccbdb",Number (-4.233968374468481))]),("bccddbdaabdca",String "adadbdb"),("cb",Array [Integer 6,Integer 6,Array []]),("adbdddcdc",Integer 8),("dcdcdabcccada",Boolean False),("",String "adbacbcacabbda")]),("b",Integer 3),("bacc",Object [("",String "adaadaadb"),("cacdcc",Null),("bdbbcbbcbacaa",Number 5.456332976215438),("bdbbddccdd",String "abdacdd"),("ddd",Boolean True),("cccdbcbcbbbd",Boolean True),("cabcccacacbc",Null),("bacbadcbb",Integer (-4)),("bbddcbda",String "aaddacc"),("cdbbdacbaddca",String "cd"),("bbccbdbcdb",Integer (-3)),("adadca",String "dcdbbcdabdcc"),("badacaadda",String "ca"),("dccddccabaaaa",Integer 12)]),("bad",Integer 14)],[("bacbbbcccb",Array []),("",Integer 14),("abdcaadbacccdaba",Integer 1),("",Integer 4),("acacdbbcdbadadcd",String "abdccccddcba"),("bcaadcaddbacc",Array [Integer 9,Integer 10]),("bcaccdaacdd",String "ccbabaabbdccbbc"),("bdda",String "dcbddcdbbd"),("cbbcdcb",Integer 8),("adcaaacadbbd",Array [Integer 6,Array [String "ddcabdb"],Number (-10.794464591451463),Array [Boolean True,Boolean False,Array [String "",String "cddbadabadba",String "dbbddcbdcdddbcd"]],Array [Array [Array [Number (-9.584936957822407),Integer 13,Integer (-13),String ""],Null,String "dbaaaabd",Boolean False],Number (-9.103801008665945),Number (-15.669873894702254),String "bacdbbadd"]])],[("cadacdbabadcdbcca",String "cbbaaadcabbc"),("cdcbcdcacaadcacdcd",Number (-11.344946874146851)),("dacdbadcdcdaddadb",String "dbdadadbcaddacaab"),("d",String "baabdaacbacbacd"),("ccdbcbdaaaab",Array [String "adcacbcbcb",Number 11.371645909814452,Boolean False]),("cabbdbbbdddabad",Boolean True),("daadcbbaacad",String "dacbbabc"),("cccdcdddbdbb",Null),("bbaaddbccad",String "ddbadbadabdcabddbb"),("adaddbb",String "caaccbcdaccbcc"),("bccbaaddbdccaac",Integer 4),("acba",Number 6.4927984728123365),("dddbc",Integer 9),("addcbdbaabbd",String "ccbcadbd"),("cdaddadcbbbbcdd",String "daacdabccacdcb")],[("cdacddcdbbdbddbdcaa",Integer (-13)),("",Integer (-13)),("aa",String "babcdcabc"),("cdacdadad",Null),("dc",Number (-18.850184025615846)),("bcccdbcbacadbdbb",Object [("bcbabbaad",Number (-14.65840130640445)),("cddaccdbb",Array [Integer (-8),Array [String "cbcbaaccbcbdbddba",Integer 14,Boolean False,String "dbcbdbbc"],String "aaaabcdacadaabbcaa"]),("cdadaadbdcdabbbc",String "cabbccaccbbbcdcbdd"),("cdddadddbcabc",Number (-13.063959229877424)),("bcddbdd",String "cdbbbbd"),("bacbccbcc",Integer 15),("bdabd",Array [Object [("cacaadbbbddacacbab",String "abbcccbbdaaabd"),("dddaccbccbcbbaacbb",Array [Number 12.710841927135505,String "cdd",Boolean False,Boolean False]),("abcbbd",Array [String "abcaccdbaa",Object [("adbbacabb",String "adbbacdbddccdcdacc"),("babbc",Object [("bbacdcdd",Number 13.065182362183513),("acbb",String "dcdd"),("adaad",Array [Integer (-8),String "abcadad",String "bdaaa",Object [("dacd",String "bc"),("cdacbacabbdba",Integer 6),("ccaabaccaabccbddcbab",Object [("adabdacadcbadadc",Object [("dbabbcbdcbcbadddbbcd",Array [Integer 16,Integer (-7),String "cccabaacbcbaadbbdacd",Number 16.36355895036726,Number 7.729200372593592e-2]),("",String "bababbaaba"),("cdcdcbabadbc",Integer 19),("aabbbdcdcbcddbcc",Number (-8.29673113368859)),("ddaccdcd",Boolean True),("ccddadabcbcbccaa",Number (-9.714269114523773)),("adaddb",String "aadaacccbdccabc"),("cdbdaccdcbbdddccadab",String "badacadd"),("abbabccc",Array []),("dbabbcbabdacdddb",String "bddd"),("abcdbaa",Null)]),("cbaccdbcaadd",String "dcbbd"),("caaabdcc",Number 3.2549426856210246),("dbacb",String "dbcbdddddbdba"),("dbbbbbbcaccbcd",String "dd")]),("bdbddbdccbbaabbadcbc",Array [Object [("dc",String "db")],Boolean False,Boolean True,Array [String "adabb",String "ccddacd",Array [Boolean True,String "aabdcddb",String "ababbcdabddcbaaddcd"]],Null]),("badbddb",String "bcacabbac"),("ababca",Object [("cbbcadbaccb",Integer (-9)),("bdbaaa",Number 17.939656875341925),("dcadbdba",Number 17.07765314249972),("bbbcc",Array [Array [],String "baacbbcdccdadbadddb",Integer 9]),("dbdcbcda",Number (-6.244985739726032)),("cabcddbbabadddbdcd",String "bbc"),("ccccbca",Object [("aa",Integer (-17)),("caddabcbcccbdbdaaa",Number 3.88667326625171),("cdbcb",Null),("ddadacbab",String "bcaddbcbdacd"),("acdadcacb",String "ccbabddacaaacabcdbb"),("bcbdaacbdd",String "b"),("bcadad",Number (-13.115495059320558)),("caddcbccbabda",String "bbdaabcabaaaadaaa"),("ccccaaaabdacccaba",Array [Boolean True,Integer 1,String "ddbccacdabbca"]),("cbdbccddbcadccdcaaa",Integer (-16)),("cacd",Number 3.5058632739302378),("bbbbcdd",Array [Array [String "dbbaadadbab",Null,Boolean False,Array [Integer 8,String "bacda",Array [String "accbbdb",Number (-9.05025154072599),Array [Integer (-5),Integer 0]],String "adbcaabbccdaba"],Integer 11],Null,Number 0.6377619321927971]),("bab",String "cadd")]),("cba",Integer (-20)),("aaacdacacaadabbbdd",Boolean False)]),("ac",String "aadcabccbdcdacacbca"),("ddaabdd",Array [Array [Number 15.360506027449851,String "daca",Number (-16.564979926846533),String "cdbbaac"]]),("adcccb",Number (-9.732558346726059)),("bcb",String "c"),("dcabcdbdbcbbcadd",Integer (-7)),("bbccdc",Boolean True),("ccd",Integer (-16)),("adabbcb",Object [("cbbccabcadbdb",String "dbdabcadbbcbdc"),("aacbab",Number 14.8158299232136),("bcbdaaddabddcacabaca",Number 1.6476076518086467)]),("adadacaabcadadbdcdda",Null)],Boolean True])]),("acabc",Integer 3),("bbadaddcabcddcaaa",Boolean True)],String "cbcc",Integer 0]),("ca",Array [String "babac",Array [String "",String "cccdcbadd",Boolean True,Object [("ddbdcbcabcabdccdd",Integer 16),("dacdccacdadcaca",Integer (-3)),("bcacaacbbacaa",String "adbababddccaddbddcb"),("dbadccdcdcacadacd",String "dddccdcaadbadd"),("cddcbcccdcbcbdcd",Integer (-9)),("addcbaaa",Array [String "cadbbba",Array [String "cadccbbbdabd",Integer 2,Integer 3,Boolean True],Integer (-19)]),("addacbbcabddd",String "cdacd"),("dbddbcdaccbbccdbbdcc",Object [("baadbdcba",Number 11.86403205965541),("bdcbcbbbbdbcadcd",String "bcccbcabcaca"),("acdcaaadc",Integer 10),("ccadbbd",String "baadaadbcccdcad"),("ccadbabbcadb",Boolean True),("abdadadcdbadadd",String "cacacccbcb"),("bdaabccbddcbcdcad",Number 18.17429341942467),("ddacdbadcabbdbdbab",Array [String "dad",String "cacbddcbc",String "abbc",Integer (-18),Number 8.867660606253414]),("abbddcacbb",Array [Number 19.32255751958743,Integer 5,Null,Object [("ccbdcad",Integer (-3)),("ad",Integer 7),("dcabacddbccabbacbacc",Number 11.293850684136634),("bddacdddcbadcbdbbdd",Array [Integer 1,Number 1.701602016078542,Object [("bddbbaadbacbabda",Number 6.58777900370565),("dbdcdadcbdabddcc",Number (-3.2348506997054582)),("bc",Integer 9),("bccccbddbbcbadaddd",Array [Array [Integer 11,Number (-16.034954790945882),Object [("babccd",Array [Null]),("aaaadbdbba",Array [Boolean False,Array [Number (-3.2172318922755356),String "dcddadccbcd",Boolean False],Number 3.9015887022592177,Integer (-6),String "ba"]),("bacbbadbcdcaaddadc",Boolean False)],Integer (-9),String ""]]),("",Array [Boolean False,String "dabbdac",Number 6.055449551233087,String "c",String "dabdacdada"]),("ac",Integer 12),("bbbddabaccba",Array [Integer 18,String "bbccbd",Number 14.236215406760326])]]),("adcaaddbcbcdadcdbcac",Array [Boolean False,String "dbaddccccabbdddcb",Array [String "bccdcabccdccaadd",String "bbcdbdcccb"]]),("bdcda",Number 14.673879430090995),("bbaabd",String "bdababcbddbcdbccdc"),("ccccccdbabcaaadca",String "cdb"),("bcbabcbbcd",Integer (-4)),("dbaaa",String "bcccdcdb"),("ddbbabcabbbdcaca",Array [Array [String "cdbacbccacda",String "ccaca"],Integer 0,Integer 6]),("dccbdaad",String "ccabbabadabacdddb"),("bd",String "cdb"),("dbbbcaccabacdc",Object [("cbccdaddbbb",Integer 16),("cbaddbddba",Array [Array [],String "abd",String "adaddcbcc"]),("bcbdcdddbc",Integer 9),("daccdccddbdcd",String "cbaddadcaaaabbbada"),("ddacbbbacdbcab",Integer 1),("abcaaabbaaddddcbadc",Object [("caaac",Number (-5.288534942400409)),("caddcdb",String "aacccd"),("dcccaacacadc",String "abadddbcccdaabc"),("ccbcbaddcabdaadcba",Boolean False),("addbd",String ""),("bbcaac",Boolean True),("ddbaca",String "b"),("bbbacbddddcdacdbcab",Integer 4),("dadcadadd",Integer (-15))]),("d",Number 18.34167229496483)]),("dbccaddacdbbccaabacb",Array [String "dbd",Array [Array [Array [Integer 2],Array [String "acb",Boolean True,String "caddbccdccbadda",Array [Array [Integer 15,String "aadaccaccabccccb"],Number (-4.577377033398191),String "bdbaddcabc"]],Number (-12.811237089814531)],Number 1.6178998931326238,Integer 8,Boolean False],String "daadaa"])]]),("cacdcabcbabbabd",String "dddcaaacbb"),("baabd",String "bdddbcbddadcaa"),("daccbcabdbdbabd",Array [String "abcbccaddcdccdd",Integer 6,String "dbcbddcd"]),("bcda",String "")]),("cdad",Null),("dadbadbbaacabbd",String "dabd"),("bbbdbabaacccabdaa",String "d"),("dbabbbabcdb",Integer 17),("aabddadbccd",String "cdc"),("adbddabadccdcbd",Array [Integer 1,String "ddaba",String "adcbaca"]),("db",Array [String "bddcbcbbcaaadbdccca",Boolean False,Object [("cacbddaabaddacbcabc",String ""),("dadacaacacbcbcbaad",Integer 17),("bbadbbbabbca",Number 19.737445740784715),("cccccbbcdabdbabacdbd",Boolean True)]]),("adccdabdacd",Array [String "bdbadbabbbdbabcbda",String "bccdaabbaddccbccd",Null,Boolean False]),("ac",String "dacacaccbdd"),("dadabbcdadacbccadbda",Array [String "ccddbdadabbbdbdda",String "dca",Integer 18])],Array [String "aacccaaacbdbcbadabba",Array [Number 15.82524301245293,String "bdddcdcbbddbccbd"],Array []]],Number (-9.160195727654543),Null]),("ccacdbdadadcd",Number 7.092135046332369),("bbdbadbbcabdcddc",String "ccccad"),("dcbdbaabddbdcba",Boolean False),("bdaccdbcbddadccacd",Array [Boolean True,Array [Number (-15.231503015419934),Boolean False,Array [Array [Array [String "bcdcdbbcacbdddddbb",String "bdbbaacacacaddabca"],Integer (-13),Object [("c",String "dbcdcdcbaabadccbdadc"),("dbccabaacaacbdbccadb",Array [String "d",Number 12.110490204495186,Boolean True]),("abcaccdccbcddcabca",Array [String "adbbdcadcadabdcabca",Array [Number (-13.50914977233739),String "baacda"]]),("aaadcbadaaa",Integer 12)],String "accddaacbacba",Boolean False],String "dccaababdddacab",String "bdcaddadccadcb",Number 12.392311654347862],String "caaaaddbdadcaababbc"],String "cdbcdcacdbbdddc",Number 8.403054523155674]),("bdbdcddcacdcccacacca",Array [Integer (-4),Null]),("aaaacaabcdabd",Array [Integer (-3)]),("abab",Integer 7),("ddbbbddadbdbcaabc",Null),("dbbcba",Array [Integer 6]),("d",String "ddcacbcdbbda"),("cdccddbadaaccdda",Boolean False),("cdbacadc",Number 5.773626787958525),("b",Boolean True),("bbbbdaaadcbdcb",String "abbbbcddbaaaddd"),("bbaddddb",String "cda"),("cddbd",Array [String "ddadabcdaa",Number (-13.4195593912459)])],Array [Array [Integer 4,Integer 5,Integer 8,Null],Object [("ab",Array [Object [("cdcddaaa",String "dccdac"),("daabcddadbdddb",Number 2.2014171769882265),("bdccadcab",Array [String "dbccdacd",Integer (-3),Array [Object [("bbccbdcaabac",String "bdcadbbbbaa"),("acdbbdcbddcdad",Array [String "ccabcdabbbdc"]),("abdbbcbcbdababcdcb",String "cb"),("dccdbbbadcddacacb",String "c"),("bacacbbbbbcaabad",Number (-2.5802396564028562))],Array [String "cbcdd",String "bbdbaadcdabcacbbb",Number (-15.545322301415418),Array [Number 15.642866105895783,Number (-17.801118227308375),String "adcbcbadcacb",String "dcdb",Boolean False]],Array [String "babc",Integer (-16),Null],Null,String "cbbbaba"],Boolean False,Integer 20])]]),("dadac",Object [("cababbbbddbaccaaadac",Integer 3),("cddcbbcaadacdcc",String "b"),("dabdaccbacacbb",Boolean True),("adddabbdacdca",String "cbdacbdcdda"),("aaabcccabddbadbdd",String "bbdcadccacbc"),("abcacbbbdbcca",Boolean True),("c",Boolean False),("ddcd",Boolean True),("acadaccd",Integer 1),("adacbbcbccaddbaabaca",String ""),("ccccccd",Integer 9),("aadaabcabdbd",String "acb"),("bbc",Array [Integer 3,Object [("aacabcadbacbbacadbd",String "bbccbcacacaccad"),("bacbbbaaacdb",String "dda"),("cdcbcabd",Null),("ccbdbdbddbbccbddca",Array [Number (-8.575440463538186),Null]),("cbadccccca",String "dbdbcccdabdcaabdb"),("c",String "a"),("abbcdadbbabbc",Integer 9),("bbcabdaa",Number (-12.79156126770995)),("dcaddbcccbbdbbdbd",Number (-18.22021384719732)),("cbd",Integer 11),("ddababcabcddabbd",Number 17.11313196454543),("d",Array []),("baabbd",String ""),("ddcbcaaaad",String ""),("cdccbcbbcdaadbcc",Boolean True),("cbac",Array [Integer (-7),Number (-1.3636186872812408),Object [("baddaddbcababd",String "dddd"),("baddbbcbdbaaaabddbbb",Boolean False),("bcddaadbaadbbd",String "bccdbbcbbccccaab"),("cbdbbc",Array [Array [Array [Array [Array [String "abadbabdcccabcab",Array [Null,String "cdacdbdbdcaba",Array [],Boolean True,Array [Array [Number (-6.905949317615137)],Boolean False,String "caaacacdddcbabdcacaa"]]],Integer 12,Number (-19.82648403652894),Array [Array [String "dcbacaccdcddbcdbdad",Integer 18,Integer 14,Integer 4],Number 6.304515911784546,String "bcadb",Boolean False,String "bcddbbbda"]],Integer 14,Array [String "dbbacdcdccdbbd",String "dbbaad",Null,Array [String "cdccbcdbcadcadcdddd",Integer (-3),Integer (-16)],Object []],Boolean True],Integer (-5),Integer (-17),Number 11.612244025901068,String "adbaabdba"],String "cbdc",Null,Boolean False,Object [("bddabbba",Array [Integer 7,String "acadcbbdbacabcaab",Number (-13.652697627049896)]),("cdaccaddccaaabcbada",Array [Boolean False,Null,Integer (-1),Integer 12]),("dcddb",Integer (-11)),("adabcbaa",Array [Boolean True,String "addcccbdcaddcc"]),("adbac",Array [Array [String "dcbbcab",Array [Number 9.094015982683711,Integer (-15),Null]],Integer 7,String "dcdabb"]),("bbdababcbadccacdcdb",Array [Array [Integer 18,Array [Array [Array [Array [Integer 12,String "aadbddcda",String "aababdcdbaddc"],String "babbdcaaa",Array [Array [Integer (-12),String "adcacccbabacbaabb",String "aa",String "caacd"],String "ab",Null,Integer (-3)]]],String "ddaddcaabddbbada",Integer 13,String "addabdcabddccab"],Integer (-4),String "aaabb"]]),("d",String "daccdaadcdbc"),("",String "bcbdcbba"),("",Integer 12),("badbccaccb",String "bcbcabbcdbdacbba"),("acccacbdadd",Integer 15),("acddda",String "ccbbcaacbb")]]),("cadbbdbbadcbdbccbb",Integer 14)],Number 18.637306134132082]),("bd",Integer (-16)),("daddabddbabdbd",Integer 19),("bdacbbcbdac",Number 11.186702893609533),("abadab",Array [String "acbcddcaadbdbddbdcdd",Array [String "cbdbcab",Boolean True,Number (-18.38625693686346),Boolean True,Integer (-2)],Integer (-18),Array [String "adad",Array [Integer (-14),String "dbadcdbadc"],Integer (-7),Integer 15,String "cbcad"]])],Integer (-8)]),("dcbabbadcabbcdabd",Number (-16.566543809366163))]),("",Integer 20),("cdcda",Number (-5.481756154595759)),("",Number 1.3464511645215913),("cbcddccc",Null),("dadbbcbcddadadaa",Array [Integer (-18),Boolean False,Object [("bcc",String "ccdbdbddcbcdd"),("cdbdbccbdbbacda",Array [Array [Array [Boolean True,Number 7.447711093958763],Array [String "cdcdaddaccbbaaadcdb",Integer (-3),Number (-15.617069413660012),Object [("dbcababda",String "dddbab"),("daddcbc",String "dddcdacdbccdabdbacbc"),("accdabdbbbdabdac",Array [Boolean True,Object [("addaadbbaadd",Number 3.019227361927531),("ca",Boolean False),("dddc",Boolean False),("cbdbadcaabcdadabdda",String "ccbdbadbdccaddccddb"),("babda",String "acbbaccbb"),("acba",String "cacdcdbccbaaacabb"),("cdddddcdbabcdacac",String "bcababbcdbacdbcadb"),("ccacaaddbc",String "bbccddacdadcc"),("dbccbabdbcddd",Number 7.837137672741288),("addbaadadbcd",Array [Null,Boolean False,Boolean False,Integer (-16)]),("ddccdcd",Number (-11.499257727640432)),("adccabdb",Number (-6.912798745848132)),("ccbddb",String "ccdbdabdbbddacbd"),("bcb",String "bdcdbdacdcdadcaddbac"),("dcccaaaa",String "abaabccbcccdddd"),("",Integer (-8)),("acddcdd",Array [Integer 20,Boolean True,String "caadd",String "bdaba"]),("cbacbbdcaddbdca",String ""),("dbcaadbddbbbaaabdd",Boolean False),("ccaccbaab",String "adddddc")],Boolean False,Integer 5]),("ccaaddddcdabdacbd",Number (-5.281479754591849)),("bcacdcaadccdbdbcba",String "a"),("daabcbdcabdacbbc",String "bacb")]],Integer 12,Array [String "bdadcabbcbdaca",Array [Array [Array [Number 0.3745796243840892,Boolean False,Integer (-12)],Array [Array [String "daccbb",Number 18.250879934442427,Boolean False],Array [Integer 19,Array [String "badcacabdbdaddab",String "bcb",String "cdddaaccccddbacbbc",String "bcada",String ""],String "dcaadbdadddcd",Array [Boolean True,String "cdacd",Number 7.902427455029159,Number (-15.77432115127512)]],Number 6.785663939525221,String "accbcba"],Array [Boolean True,String "dbb",Boolean True,Array [String "ddadcaadabddbdbc",Array [Number 19.218154404688516,String "cccbccababdbcda",String "bc",String "cddddb"],Number 11.832585074862275,Array [Array [String "",Integer (-6),Number 7.6969348419270505,Number (-18.51888251129915)],Integer 8,Array [String "dcbcdcddabadaa",String "a",Integer 12],Boolean False,String "aabbc"]],Null],String "bbddcbacacb",Object [("cbbcdbbdcccca",Integer (-4)),("aaaa",Array [Boolean False,String "ccbadbb",Array [Null,Array [Boolean True,Object [("dcddbcbaacbbacadcc",Integer (-16)),("acaccba",Number (-5.863829162472604)),("ababaa",Number 16.943031585795143),("abadcdaadbbcaacdaab",String "aa"),("babcbcccdbcadd",Integer 17),("dbcd",Integer 19),("badcdaacb",String "bcacaadcbadbbbbdbadb")],Integer 10],Array [Array [Array [Array [Boolean True,Boolean False],Boolean True],Array [Integer 8,String "dbcabcd",Array [String "bcddaa",Array [Array [],String "bababcdcbcd",Integer (-7)]],String "cdaabba"],String "bbacddadacccbcbdada"],Array [Number (-11.385061843509968),Array [String "cd",Array [Array [String "ccdba",Boolean True],String "",Number 3.609746326194456],Null,Array [Integer 4,String "acdbdaaaabdccbaa",Array [Number 2.0753631709163556,String "adadaccdbdcdcbcdcd"],Array [String "dccbdacadbabcdcbbd",Array [String "bddcdadcbbbcacaac",String "dbbacc",String "cabdbaccacbadadcb"],String "bcdcccbbdbacaccddcc",Number (-4.9081317835410525),Integer 14],Number 11.32173516513499],Number (-4.432876195204106)],Integer 11,Integer (-9),Integer 11],String "ddaacdcabbb",String "ddabbcabcaddacb"],Integer (-9),Object [("adababcadabacabdda",Array [String "acb",Boolean True,Integer 0,Number (-4.579463084312932)]),("dbcbacadaccba",String "caccdb"),("dddcadbdaaadaacbd",Integer 3),("adcddcacdcc",Boolean False),("bdaaaaddbdccdaca",Integer (-14)),("cabdddcdcad",Number 19.80932949604156),("cdcba",Array [String "bcaa",String "aacacdabbcddd",Boolean False,Array [Array [Array [Boolean False],String "dcabaabadcbaab",Array [Boolean True,Array [String "",Integer 9,Array [Boolean False,Boolean True,String "bccbbdcbaaadcc",Integer (-7)],Boolean True,Integer 17],Number (-11.835719686632116)],Boolean False,String "b"],Number 15.297434076694577,String "adabddd",Array [Array [Integer (-9)],Number 15.62604853477156,Boolean False]],Boolean True]),("dbdcaddcaa",String "cb"),("adbddcada",Integer 6),("caccbbadcac",String "cddcbbdcbbdcadbdcd"),("caccaabadbcdcbcac",String "ddabaacbbdcb"),("cdaa",Null),("dddccbdcadbdbbcbbc",Number 0.475136059979505)]],Array [Array [Boolean False],Null,String "acdacaacdbcd"],Object [("cbaaaccd",String "dcdbbbdbdccbcc"),("bbcdbdaacaababbddab",String "aadbddaddcc"),("ddbacaccabbdadd",Boolean False),("bac",Null),("cdddb",String "bdcc"),("aadd",String "cacbbbddb"),("baacdcddbaabcadaadd",Integer (-8)),("aacbaa",Array [Object [("cbbaaacbbcddcbbdbad",String "dabadaab"),("adadccdbabccad",String "acaabdbdacbccbaa"),("d",Integer (-16))],Array [],String "bbaaa",Array [],Integer (-8)]),("accbacddcccdb",Number 16.518782410176875),("bbbabddadcad",String "baacacbdbdaaadadcd"),("a",Integer (-11)),("cdcdadbdc",Integer (-3)),("bcc",Integer 15),("cccbbb",String "ddddbdbacccdac"),("bdbadaacaaabc",Integer 2),("acdaddabcaadbabb",Boolean True)]]),("cacccadcddcaddccaa",Array [Integer 4,Boolean False,Array [String "daaaaaadcdbaa",Number 12.124715374676837,Integer (-20)]]),("ddcabbbdcdccaa",Integer 5)]],Array [Number 5.007634052760762,Integer 4],String "bdabaaaadb",String "abdccbb"]],Boolean True],Number (-17.698725688467924)]),("caadbaaccbb",Integer 1),("dddbaaddddb",String "ccababccdcddb"),("bda",Number 8.143861692497186),("dbddc",Array [Array [Boolean True,Integer 10],Array [Number 16.093806056013335,String "cbcbadcaaaca",Boolean True],String "dbacbbcda"]),("",Boolean False)],String "cdc"]),("d",Number (-19.480469656135877)),("caacdbacbaacaac",String "acdcabdddcabdddcd"),("cbcdbabdbbdddabbcdc",Number (-12.719787249133821)),("bdddabcd",Number 6.592773541587172),("cabbcbabacaadcbbcbb",String "abd"),("bcaccccdcaddb",String "bdbdbdadaddbd"),("cccab",Number (-5.64242560642892))],Boolean True,Object [("bcc",Number (-14.480951786605832)),("dcbbad",Array [Boolean True]),("cadadacbaaaccac",Null),("ac",Integer (-13)),("cbaacdaaaacbbcdccbb",Null),("acbbadbdaadbbac",String "cba"),("abdcbcdcbbad",String "acababbdbabcbcdaabdc"),("bdacadbcbaabcaadbaca",Number (-19.070223054458207)),("dadaaabcbbbaacdc",Number 9.868285820530303),("baaaadbabcbcbddbaaa",Boolean False),("dacccdccdbc",String "cccbabdcdcadbab"),("adcdadaabdcbdadbccac",Integer 19)]],Integer (-11)]),("ddacddaaca",Array [Number (-4.655259951008644),String "caabbdbdb",Integer 0,Array [String "adbda",Integer 15,Integer 4,String "dbdaaa",Integer 2]]),("dadaacdbccadbbadbbb",Boolean False),("bccdbdcccadcbdbcb",Null),("acdc",Integer (-2)),("ccabcdadbaa",String ""),("bdccdabcadcbcdaaabd",Object [("bcddadcbcacccad",Integer 13),("cad",String "abcbabbcbbbbcbda"),("aacbc",String "cbccdbadcccaaccad"),("cabaccaaabdb",String "abddabbdbcccccada"),("cbacbdaaaba",Integer (-9)),("babcbbaadacbd",String "cbabccbd"),("cacabcdbddbdda",Boolean False)]),("abddccbbdccd",String "ddbdacaddccdddc"),("bbdcaccbcbcabccb",Null),("dbdbbbdcccbbaaccb",Number (-13.302522211617255))]),("dccc",String "cbb"),("bddacbbaca",String "ccbacd"),("abcbbbc",Array [Integer (-4),Array [Array [Array [Null],Array [Object [],String "addaddacba",String "bcbdc",String "da"],String "adbbcaddbdcda"],String "aac",Number 12.072666782878116,Number (-2.59391599402381)],Boolean True]),("abdccdbccbdcaaabb",String "bdcaacdad"),("baad",String "cabcddbbaa"),("baccac",String "dbbd"),("bbcdacdcaabcadbcbdbd",String "cbccbcdacd"),("adddbcabdcbacbddbccb",Number 6.290872743506403),("bcbdd",String "dacba"),("c",Integer (-8)),("dbaabbccddcbcdac",Null),("",Integer 5),("ab",Array [Array [String "adcadcdba",Number (-10.738961985445417)],Array [String "ab",String "d",String "dbbabaacddd",Number 9.941656496553394,Integer (-1)],String "dddd",Array [Integer 12,String "dcacadbacdcbcabb",Array [],Array [String "cccabccadadcaa",String "bcda",Array [Boolean True,String "ddbccdc",String "cad",Number 3.276770931665421]],Integer (-14)]]),("db",Boolean True)]]

instance Arbitrary Value where
  arbitrary = genValue
  shrink (Object (x : xs)) = Object <$> ([x] : [xs])
  shrink (Array (x : xs)) = Array <$> ([x] : [xs])
  shrink x = []

-- instance Arbitrary Key where
--   arbitrary = listOf genChar
--   shrink x = []

-- instance Arbitrary HSON where
--   arbitrary = genHSON

--   shrink (x : xs) = [x] : [xs]
--   shrink [] = []

---------------------------- Sample HSON ---------------------------------------
hsonEmpty :: HSON
hsonEmpty = []

hsonSingle :: HSON
hsonSingle = [("name", String "bob")]

hsonArray :: HSON
hsonArray =
  [ ("bob", Array [Integer 1, String "hi", Object [("name", String "Jose")], Null])
  ]

hsonDog :: HSON
hsonDog =
  [ ( "dog",
      Object
        [ ("name", String "bill"),
          ("age", Number 4.2),
          ("siblings", Boolean False)
        ]
    )
  ]

hsonSchool :: HSON
hsonSchool =
  [ ("name", String "School"),
    ("foundedYear", Integer 1975),
    ("isPublic", Boolean True),
    ("cost", Null),
    ("students", Array [String "a", String "b", String "c"]),
    ( "address",
      Object
        [ ("city", String "Philadelphia"),
          ("state", String "Pennsylvania"),
          ("buildingNumber", Integer 123)
        ]
    )
  ]

---------------------------------------------------------------------------------
